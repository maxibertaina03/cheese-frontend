{"ast":null,"code":"// src/services/api.ts\nconst API_URL = process.env.REACT_APP_API_URL;\nexport const createApiFetch = (token, onUnauthorized) => {\n  return (url, options = {}) => {\n    return fetch(url, {\n      ...options,\n      headers: {\n        ...options.headers,\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'application/json'\n      }\n    }).then(response => {\n      if (response.status === 401) {\n        onUnauthorized();\n        return Promise.reject(new Error('Token expirado'));\n      }\n      return response;\n    });\n  };\n};\nexport const apiService = {\n  // Auth\n  login: async (username, password) => {\n    const res = await fetch(`${API_URL}/api/auth/login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        username,\n        password\n      })\n    });\n    return res;\n  },\n  // Unidades\n  getUnidades: apiFetch => apiFetch(`${API_URL}/api/unidades`),\n  getHistorial: apiFetch => apiFetch(`${API_URL}/api/unidades/historial`),\n  createUnidad: (apiFetch, data) => apiFetch(`${API_URL}/api/unidades`, {\n    method: 'POST',\n    body: JSON.stringify(data)\n  }),\n  updateUnidad: (apiFetch, id, observaciones) => apiFetch(`${API_URL}/api/unidades/${id}`, {\n    method: 'PUT',\n    body: JSON.stringify({\n      observacionesIngreso: observaciones\n    })\n  }),\n  // ← NUEVO: Eliminar unidad (admin only)\n  deleteUnidad: (apiFetch, id) => apiFetch(`${API_URL}/api/unidades/${id}`, {\n    method: 'DELETE'\n  }),\n  // ← NUEVO: Eliminar unidad del historial permanentemente (admin only)\n  deleteUnidadPermanente: (apiFetch, id) => apiFetch(`${API_URL}/api/unidades/${id}/hard`, {\n    method: 'DELETE'\n  }),\n  createParticion: (apiFetch, unidadId, data) => apiFetch(`${API_URL}/api/unidades/${unidadId}/particiones`, {\n    method: 'POST',\n    body: JSON.stringify(data)\n  }),\n  // Productos\n  getProductos: apiFetch => apiFetch(`${API_URL}/api/productos`),\n  // ← NUEVOS: CRUD Productos (admin only)\n  createProducto: (apiFetch, data) => apiFetch(`${API_URL}/api/productos`, {\n    method: 'POST',\n    body: JSON.stringify(data)\n  }),\n  updateProducto: (apiFetch, id, data) => apiFetch(`${API_URL}/api/productos/${id}`, {\n    method: 'PUT',\n    body: JSON.stringify(data)\n  }),\n  deleteProducto: (apiFetch, id) => apiFetch(`${API_URL}/api/productos/${id}`, {\n    method: 'DELETE'\n  }),\n  // Tipos de queso\n  getTiposQueso: apiFetch => apiFetch(`${API_URL}/api/tipos-queso`),\n  // Motivos\n  getMotivos: apiFetch => apiFetch(`${API_URL}/api/motivos`),\n  // Usuarios (admin only)\n  getUsuarios: apiFetch => apiFetch(`${API_URL}/api/usuarios`),\n  createUsuario: (apiFetch, data) => apiFetch(`${API_URL}/api/auth/register`, {\n    method: 'POST',\n    body: JSON.stringify(data)\n  }),\n  updateUsuario: (apiFetch, id, data) => apiFetch(`${API_URL}/api/usuarios/${id}`, {\n    method: 'PUT',\n    body: JSON.stringify(data)\n  }),\n  deleteUsuario: (apiFetch, id) => apiFetch(`${API_URL}/api/usuarios/${id}`, {\n    method: 'DELETE'\n  }),\n  // Elementos\n  getElementos: apiFetch => apiFetch(`${API_URL}/api/elementos`),\n  getElemento: (apiFetch, id) => apiFetch(`${API_URL}/api/elementos/${id}`),\n  getElementoMovimientos: (apiFetch, id) => apiFetch(`${API_URL}/api/elementos/${id}/movimientos`),\n  createElemento: (apiFetch, data) => apiFetch(`${API_URL}/api/elementos`, {\n    method: 'POST',\n    body: JSON.stringify(data)\n  }),\n  updateElemento: (apiFetch, id, data) => apiFetch(`${API_URL}/api/elementos/${id}`, {\n    method: 'PUT',\n    body: JSON.stringify(data)\n  }),\n  deleteElemento: (apiFetch, id) => apiFetch(`${API_URL}/api/elementos/${id}`, {\n    method: 'DELETE'\n  }),\n  elementoIngreso: (apiFetch, id, data) => apiFetch(`${API_URL}/api/elementos/${id}/ingreso`, {\n    method: 'POST',\n    body: JSON.stringify(data)\n  }),\n  elementoEgreso: (apiFetch, id, data) => apiFetch(`${API_URL}/api/elementos/${id}/egreso`, {\n    method: 'POST',\n    body: JSON.stringify(data)\n  })\n};","map":{"version":3,"names":["API_URL","process","env","REACT_APP_API_URL","createApiFetch","token","onUnauthorized","url","options","fetch","headers","Authorization","then","response","status","Promise","reject","Error","apiService","login","username","password","res","method","body","JSON","stringify","getUnidades","apiFetch","getHistorial","createUnidad","data","updateUnidad","id","observaciones","observacionesIngreso","deleteUnidad","deleteUnidadPermanente","createParticion","unidadId","getProductos","createProducto","updateProducto","deleteProducto","getTiposQueso","getMotivos","getUsuarios","createUsuario","updateUsuario","deleteUsuario","getElementos","getElemento","getElementoMovimientos","createElemento","updateElemento","deleteElemento","elementoIngreso","elementoEgreso"],"sources":["C:/Users/Usuario/Desktop/sistema-stock/cheese-frontend/src/services/api.ts"],"sourcesContent":["// src/services/api.ts\r\nconst API_URL = process.env.REACT_APP_API_URL;\r\n\r\nexport const createApiFetch = (\r\n  token: string | undefined,\r\n  onUnauthorized: () => void\r\n) => {\r\n  return (url: string, options: RequestInit = {}) => {\r\n    return fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        ...options.headers,\r\n        Authorization: `Bearer ${token}`,\r\n        'Content-Type': 'application/json',\r\n      },\r\n    }).then(response => {\r\n      if (response.status === 401) {\r\n        onUnauthorized();\r\n        return Promise.reject(new Error('Token expirado'));\r\n      }\r\n      return response;\r\n    });\r\n  };\r\n};\r\n\r\nexport const apiService = {\r\n  // Auth\r\n  login: async (username: string, password: string) => {\r\n    const res = await fetch(`${API_URL}/api/auth/login`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ username, password }),\r\n    });\r\n    return res;\r\n  },\r\n\r\n  // Unidades\r\n  getUnidades: (apiFetch: any) => apiFetch(`${API_URL}/api/unidades`),\r\n  getHistorial: (apiFetch: any) => apiFetch(`${API_URL}/api/unidades/historial`),\r\n  \r\n  createUnidad: (apiFetch: any, data: any) =>\r\n    apiFetch(`${API_URL}/api/unidades`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    }),\r\n\r\n  updateUnidad: (apiFetch: any, id: number, observaciones: string) =>\r\n    apiFetch(`${API_URL}/api/unidades/${id}`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify({ observacionesIngreso: observaciones }),\r\n    }),\r\n\r\n  // ← NUEVO: Eliminar unidad (admin only)\r\n  deleteUnidad: (apiFetch: any, id: number) =>\r\n    apiFetch(`${API_URL}/api/unidades/${id}`, {\r\n      method: 'DELETE',\r\n    }),\r\n\r\n  // ← NUEVO: Eliminar unidad del historial permanentemente (admin only)\r\n  deleteUnidadPermanente: (apiFetch: any, id: number) =>\r\n    apiFetch(`${API_URL}/api/unidades/${id}/hard`, {\r\n      method: 'DELETE',\r\n    }),\r\n\r\n  createParticion: (apiFetch: any, unidadId: number, data: any) =>\r\n    apiFetch(`${API_URL}/api/unidades/${unidadId}/particiones`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    }),\r\n\r\n  // Productos\r\n  getProductos: (apiFetch: any) => apiFetch(`${API_URL}/api/productos`),\r\n\r\n  // ← NUEVOS: CRUD Productos (admin only)\r\n  createProducto: (apiFetch: any, data: any) =>\r\n    apiFetch(`${API_URL}/api/productos`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    }),\r\n\r\n  updateProducto: (apiFetch: any, id: number, data: any) =>\r\n    apiFetch(`${API_URL}/api/productos/${id}`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    }),\r\n\r\n  deleteProducto: (apiFetch: any, id: number) =>\r\n    apiFetch(`${API_URL}/api/productos/${id}`, {\r\n      method: 'DELETE',\r\n    }),\r\n\r\n  // Tipos de queso\r\n  getTiposQueso: (apiFetch: any) => apiFetch(`${API_URL}/api/tipos-queso`),\r\n\r\n  // Motivos\r\n  getMotivos: (apiFetch: any) => apiFetch(`${API_URL}/api/motivos`),\r\n\r\n    // Usuarios (admin only)\r\n  getUsuarios: (apiFetch: any) => apiFetch(`${API_URL}/api/usuarios`),\r\n\r\n  createUsuario: (apiFetch: any, data: any) =>\r\n    apiFetch(`${API_URL}/api/auth/register`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n    }),\r\n\r\n  updateUsuario: (apiFetch: any, id: number, data: any) =>\r\n    apiFetch(`${API_URL}/api/usuarios/${id}`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(data),\r\n    }),\r\n\r\n  deleteUsuario: (apiFetch: any, id: number) =>\n    apiFetch(`${API_URL}/api/usuarios/${id}`, {\n      method: 'DELETE',\n    }),\n\n  // Elementos\n  getElementos: (apiFetch: any) => apiFetch(`${API_URL}/api/elementos`),\n  getElemento: (apiFetch: any, id: number) => apiFetch(`${API_URL}/api/elementos/${id}`),\n  getElementoMovimientos: (apiFetch: any, id: number) =>\n    apiFetch(`${API_URL}/api/elementos/${id}/movimientos`),\n\n  createElemento: (apiFetch: any, data: any) =>\n    apiFetch(`${API_URL}/api/elementos`, {\n      method: 'POST',\n      body: JSON.stringify(data),\n    }),\n\n  updateElemento: (apiFetch: any, id: number, data: any) =>\n    apiFetch(`${API_URL}/api/elementos/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(data),\n    }),\n\n  deleteElemento: (apiFetch: any, id: number) =>\n    apiFetch(`${API_URL}/api/elementos/${id}`, {\n      method: 'DELETE',\n    }),\n\n  elementoIngreso: (apiFetch: any, id: number, data: any) =>\n    apiFetch(`${API_URL}/api/elementos/${id}/ingreso`, {\n      method: 'POST',\n      body: JSON.stringify(data),\n    }),\n\n  elementoEgreso: (apiFetch: any, id: number, data: any) =>\n    apiFetch(`${API_URL}/api/elementos/${id}/egreso`, {\n      method: 'POST',\n      body: JSON.stringify(data),\n    }),\n\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}